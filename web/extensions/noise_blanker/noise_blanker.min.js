

/* web/extensions/noise_blanker/noise_blanker.min.js */
var noise_blanker={ext_name:"noise_blanker",first_time:!0,algo:0,algo_s:["(none selected)","standard blanker","Wild algorithm"],NB_OFF:0,blanker:0,test:0,wf:1,NB_BLANKER:0,NB_WF:1,NB_CLICK:2,NB_STD:1,gate:0,threshold:0,NB_WILD:2};function noise_blanker_main(){ext_switch_to_client(noise_blanker.ext_name,noise_blanker.first_time,noise_blanker_recv),noise_blanker.first_time||noise_blanker_controls_setup(),noise_blanker.first_time=!1}function noise_blanker_recv(e){if("DAT"!=arrayBufferToStringLen(e,3))for(var n=arrayBufferToString(e).substring(4).split(" "),_=0;_<n.length;_++){var s=n[_].split("=");switch(s[0]){case"ready":noise_blanker_controls_setup();break;default:console.log("noise_blanker_recv: UNKNOWN CMD "+s[0])}}else{var o=new Uint8Array(e,4),l=o[0],a=o.length-1;console.log("noise_blanker_recv: DATA UNKNOWN cmd="+l+" len="+a)}}function noise_blanker_controls_html(){var e="";switch(noise_blanker.algo){case noise_blanker.NB_STD:e=w3_slider("","Gate","noise_blanker.gate",noise_blanker.gate,100,5e3,100,"noise_blanker_gate_cb")+w3_slider("","Threshold","noise_blanker.threshold",noise_blanker.threshold,0,100,1,"noise_blanker_threshold_cb");break;case noise_blanker.NB_WILD:}return w3_div("id-noise-blanker-controls w3-text-white",w3_divs("w3-container/w3-tspace-8",w3_inline("w3-margin-between-8",w3_div("w3-medium w3-text-aqua","<b>Noise blanker: </b>"),w3_div("w3-text-white",noise_blanker.algo_s[noise_blanker.algo])),w3_inline("w3-margin-between-32",w3_checkbox("w3-label-inline w3-text-css-orange/","Test","noise_blanker.test",noise_blanker.test,"noise_blanker_test_cb"),w3_checkbox("w3-label-inline w3-text-css-orange/","Also blank WF","noise_blanker.wf",noise_blanker.wf,"noise_blanker_wf_cb")),w3_div("w3-section",e)))}function noise_blanker_controls_setup(){ext_panel_show(noise_blanker_controls_html(),null,null),ext_set_controls_width_height(400,400)}function noise_blanker_init(){noise_blanker.algo=readCookie("last_nb_algo",0),nb_algo_cb("nb_algo",noise_blanker.algo,!1,!0),noise_blanker.gate=readCookie("last_noiseGate",100),noise_blanker.threshold=readCookie("last_noiseThresh",50),noise_blanker_send()}function noise_blanker_send(){snd_send("SET nb algo="+noise_blanker.algo),snd_send("SET nb type=0 param=0 pval="+noise_blanker.gate),snd_send("SET nb type=0 param=1 pval="+noise_blanker.threshold),snd_send("SET nb type=0 en="+(noise_blanker.algo?1:0)),snd_send("SET nb type=1 en="+noise_blanker.wf),snd_send("SET nb type=2 en="+noise_blanker.test)}function nb_algo_cb(e,n,_,s){console.log("nb_algo_cb idx="+n+" first="+_+" init="+s),_||(n=+n,w3_select_value(e,n),noise_blanker.algo=n,writeCookie("last_nb_algo",n.toString()),1!=s&&noise_blanker_send(),ext_panel_displayed()&&ext_panel_redisplay(noise_blanker_controls_html()))}function noise_blanker_test_cb(e,n,_){_||(noise_blanker.test=n?1:0,noise_blanker_send())}function noise_blanker_wf_cb(e,n,_){_||(noise_blanker.wf=n?1:0,noise_blanker_send())}function noise_blanker_gate_cb(e,n,_,s){n=+n,w3_num_cb(e,n),w3_set_label("Gate: "+n.toFixed(0)+" usec",e),noise_blanker.gate=n,_&&(writeCookie("last_noiseGate",n.toString()),s||noise_blanker_send())}function noise_blanker_threshold_cb(e,n,_,s){n=+n,w3_num_cb(e,n),w3_set_label("Threshold: "+n.toFixed(0)+"%",e),noise_blanker.threshold=n,_&&(writeCookie("last_noiseThresh",n.toString()),s||noise_blanker_send())}